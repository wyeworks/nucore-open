= content_for :h1 do
  = current_facility

= content_for :head_content do
  = javascript_include_tag "sanger_sequencing/well_plate"

  = stylesheet_link_tag "sanger_sequencing/application"
  = render "shared/fine_uploader"

  = javascript_include_tag "jquery.fine-uploader"
  = stylesheet_link_tag "fine-uploader-new"

#uploader{ data: { authenticity_token: form_authenticity_token } }

:javascript
  $("#uploader").fineUploader({
    autoUpload: true,
    request: {
      endpoint: '#{upload_facility_sanger_sequencing_admin_batch_path(current_facility, @batch)}',
      params: {
        authenticity_token: $('#uploader').data('authenticity-token')
      }
    },
    failedUploadTextDisplay: {
      mode: 'custom'
    },
    validation: {
      //allowedExtensions: ["ab1", "seq"],
      sizeLimit: 1000000, // 1 MB
    }
  });

  $("#trigger-upload").click(function() {
    $("#uploader").fineUploader("uploadStoredFiles");
  });


%vue-sanger-sequencing-well-plate-displayer-app(inline-template){ ":submissions" => @submissions.to_json, ":well-plates" => @batch.well_plates.to_json }
  %vue-sanger-sequencing-well-plate(v-for="plateIndex in builder.plateCount()"){":builder" => "builder", ":plate-index" => "$index" }

  = render "submission_list"

= render "vue_well_plate"

:javascript
  window.vue_sanger_sequencing_bootstrap();
