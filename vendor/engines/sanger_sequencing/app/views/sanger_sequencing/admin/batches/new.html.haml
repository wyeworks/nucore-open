= content_for :h1 do
  = current_facility

= content_for :head_content do
  = javascript_include_tag "sanger_sequencing/well_plate"
  = stylesheet_link_tag "sanger_sequencing/application"

%vue-sanger-sequencing-well-plate-app(inline-template){ ":submissions" => @submissions.to_json(include: :samples) }

  = simple_form_for :batch, url: facility_sanger_sequencing_admin_batches_path do |f|
    %vue-sanger-sequencing-well-plate(v-for="plateIndex in builder.plateCount()"){":builder" => "builder", ":plate-index" => "$index" }

    -# = f.submit text("submit"), class: "btn btn-primary"

  %table.table.table-striped
    %thead
      %tr
        %td
        %th= SangerSequencing::Submission.human_attribute_name(:id)
        %th= OrderDetail.human_attribute_name(:ordered_at)
        %th= OrderDetail.human_attribute_name(:user)
        %th= OrderDetail.human_attribute_name(:quantity)
    %tbody
      - @submissions.each do |submission|
        %tr
          %td
            %div(v-if="isInPlate(#{submission.id})")
              .sangerSequencing--colorCoded__box(v-bind:style="styleForSubmissionId(#{submission.id})")
              = link_to text("remove"), "#", "@click.prevent" => "removeSubmission(#{submission.id})"
            = link_to text("add"), "#", "@click.prevent" => "addSubmission(#{submission.id})", "v-if" => "isNotInPlate(#{submission.id})"
          %td= link_to submission.id, facility_sanger_sequencing_admin_submission_path(current_facility, submission), class: "js--modal"
          %td= format_usa_datetime(submission.purchased_at)
          %td= submission.user
          %td= submission.samples.count


%script#vue-sanger-sequencing-well-plate{type: "x-template"}
  %table.table.table-bordered(v-cloak)
    %tr
      %th
      - (1..12).each do |col|
        %th.centered= col
    %tr(v-for="row in plateGrid")
      %th {{row.name}}
      %td.sangerSequencing--cell(v-for="cell in row.cells" v-on:click="handleCellClick(cell)" v-bind:style="styleForCell(cell, plateIndex)")
        {{sampleAtCell(cell.name, plateIndex)}}
        %br
        {{sampleAtCell(cell.name, plateIndex).id()}}

:javascript
  window.vue_sanger_sequencing_bootstrap();
