= content_for :h1 do
  = @order_detail.facility

- modal = @redirect_to_order_id.present?

- if modal
  .modal-header
    = modal_close_button
    %h2= @order_detail.product

  .modal-body
    %p.alert.alert-danger
      = text("instructions")
      = text("accessories") if @order_detail.accessories?

    = simple_form_for(@reservation, url: problem_reservation_path(@reservation, redirect_to_order_id: @redirect_to_order_id)) do |f|
      = f.error_messages

      .well.js--problemReservationForm
        .container
          .row
            .span12= f.input :reserve_to_s, as: :readonly, label: text("reservation")
          .row
            .span7
              = f.label :actual_start_date
              .row
                .span3
                  = f.input :actual_start_date, label: false, disabled: true
                .span4
                  = time_select f, :actual_start, { minute_step: 1 }, disabled: true
              = f.label :actual_end_date
              .row
                .span3
                  = f.input :actual_end_date, input_html: { class: "datepicker__data", data: { min_date: f.object.actual_start_at&.beginning_of_day&.iso8601 } }, label: false
                .span4
                  = time_select f, :actual_end, { minute_step: 1 }

          .row
            .span7
              = f.input :actual_duration_mins, hint: text("views.reservations.reservation_fields.duration_hint"), input_html: { class: "timeinput", autofocus: true }

      %ul.inline
        %li= f.submit t("shared.save"), class: 'btn'

  .modal-footer
    -# TODO: i18n
    = modal_cancel_button text: "Cancel"


- else
  %h2= @order_detail.product

  %p.alert.alert-danger
    = text("instructions")
    = text("accessories") if @order_detail.accessories?

  -# TODO: Move this to partial to avoid code repetition?
  = simple_form_for([:problem, @reservation]) do |f|
    = f.error_messages

    .well.js--problemReservationForm
      .container
        .row
          .span12= f.input :reserve_to_s, as: :readonly, label: text("reservation")
        .row
          .span7
            = f.label :actual_start_date
            .row
              .span3
                = f.input :actual_start_date, label: false, disabled: true
              .span4
                = time_select f, :actual_start, { minute_step: 1 }, disabled: true
            = f.label :actual_end_date
            .row
              .span3
                = f.input :actual_end_date, input_html: { class: "datepicker__data", data: { min_date: f.object.actual_start_at&.beginning_of_day&.iso8601 } }, label: false
              .span4
                = time_select f, :actual_end, { minute_step: 1 }

          .span5
            = f.input :actual_duration_mins, hint: text("views.reservations.reservation_fields.duration_hint"), input_html: { class: "timeinput", autofocus: true }

    %ul.inline
      %li= f.submit t("shared.save"), class: 'btn'
      %li= link_to t("shared.cancel"), reservations_path
