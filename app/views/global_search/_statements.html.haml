%h3= Statement.model_name.human(count: 2)

%table.table.table-striped.table-hover.responsive-table
  %thead
    %tr
      -# Please note if you change a header that headers are duplicated
      -# in the .resposive-header div of the cell below
      %th= Statement.human_attribute_name(:invoice_number)
      %th= Statement.human_attribute_name(:created_at)
      %th= Facility.model_name.human
      %th= Account.model_name.human
      %th= Statement.human_attribute_name(:sent_to)
      %th.currency # of #{Order.model_name.human.pluralize}
      %th.currency= Statement.human_attribute_name(:total_cost)
      %th= Statement.human_attribute_name(:status)
  %tbody
    - results.each do |statement|
      %tr
        %td.centered
          .responsive-header= Statement.human_attribute_name(:invoice_number)
          = "##{statement.invoice_number}"
          %br
          - if Ability.new(current_user, statement.facility).can? :show, statement
            = link_to t("statements.pdf.download"), statement_path(statement)
          - else
            = link_to t("statements.pdf.download"), account_facility_statement_path(statement.account, statement.facility, statement, format: :pdf)
        %td
          .responsive-header= Statement.human_attribute_name(:created_at)
          = human_datetime(statement.created_at)
        %td
          .responsive-header= Facility.model_name.human
          = statement.facility
        %td
          .responsive-header= Account.model_name.human
          = statement.account
        %td
          .responsive-header= Statement.human_attribute_name(:sent_to)
          = statement.account.notify_users.map(&:full_name).join(', ')
        %td.currency
          .responsive-header # of #{Order.model_name.human.pluralize}
          = statement.order_details.count
        %td.currency
          .responsive-header= Statement.human_attribute_name(:total_cost)
          = number_to_currency(statement.total_cost)
        %td
          .responsive-header= Statement.human_attribute_name(:status)
          = t("statements.reconciled.#{statement.reconciled?}")
